
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Quickstart%20Guide/">
      
      
        <link rel="next" href="../Application%20Guides/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.10">
    
    
      
        <title>Running Jobs - NIHPC Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slates" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-jobs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NIHPC Documentation" class="md-header__button md-logo" aria-label="NIHPC Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NIHPC Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running Jobs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slates" data-md-color-primary="red" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Kelvin2%20Overview/" class="md-tabs__link">
        
  
    
  
  Kelvin2 Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Connecting%20to%20Kelvin2/" class="md-tabs__link">
        
  
    
  
  Connecting to Kelvin2

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Quickstart%20Guide/" class="md-tabs__link">
        
  
    
  
  Quick-Start Guide

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Running Jobs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Application%20Guides/" class="md-tabs__link">
        
  
    
  
  Application Guides

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Compilers/" class="md-tabs__link">
        
  
    
  
  Compilers

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../Kelvin2%20Hardware/" class="md-tabs__link">
        
  
    
  
  Kelvin2 Hardware

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NIHPC Documentation" class="md-nav__button md-logo" aria-label="NIHPC Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NIHPC Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kelvin2%20Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kelvin2 Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Connecting%20to%20Kelvin2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connecting to Kelvin2
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Quickstart%20Guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick-Start Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Running Jobs
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Running Jobs
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#batch-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Batch Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Batch Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sbatch-directives" class="md-nav__link">
    <span class="md-ellipsis">
      #SBATCH directives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Loading Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-batch-script-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Two Batch Script Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-submitted-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Submitted Jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Managing Submitted Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-job-status" class="md-nav__link">
    <span class="md-ellipsis">
      Checking job status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancelling-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Cancelling jobs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysing-previous-jobs-using-sacct" class="md-nav__link">
    <span class="md-ellipsis">
      Analysing previous jobs using sacct
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactive-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive Jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interactive Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interactive-jobs-with-graphical-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive jobs with graphical applications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tips-for-optimising-your-jobscript" class="md-nav__link">
    <span class="md-ellipsis">
      Tips for optimising your jobscript
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-cheat-sheets" class="md-nav__link">
    <span class="md-ellipsis">
      Slurm cheat sheets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Application%20Guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Compilers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compilers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kelvin2%20Hardware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kelvin2 Hardware
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="running-jobs">Running Jobs</h1>
<p>On Kelvin2, jobs are submitted via <em>batch script</em> to a  scheduling system called <a href="https://slurm.schedmd.com/documentation.html" target="_blank">SLURM</a>. Jobs are not necessarily run in the order in which they are submitted and those jobs which require a large number of cores, memory or walltime will have to queue until the requested resources become available. The system will run smaller jobs, that can fit in available gaps, until all of the resources that have been requested for the larger job become available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To improve your experience with the queue, and that of other users, please ensure that you are not requesting excessive amounts of resources to complete your jobs. After reading the below documentation, see our <a href="#tips-for-optimising-your-jobscript">tips for optimising your jobscript</a>.</p>
</div>
<h2 id="batch-scripts">Batch Scripts</h2>
<p>A SLURM batch script typically contains four main components</p>
<ul>
<li>A 'shebang' <code>#!</code> which states the interpreter type, i.e. <code>#!/bin/bash</code> </li>
<li>A series of <code>#SBATCH</code> directives that specify resource requirements of the job and a variety of other attributes</li>
<li>Lines that load modules and set the environment</li>
<li>At least one executable bash line that runs code and any associated input parameters</li>
</ul>
<p>An brief overview of <code>#SBATCH</code> directives and modules on Kelvin2 is given below:</p>
<h3 id="sbatch-directives"><code>#SBATCH</code> directives</h3>
<p><code>#SBATCH</code> directives specify the resources required for your job and various other attributes. The definitive list of these are in the <a href="https://slurm.schedmd.com/sbatch.html" target="_blank">SLURM documentation</a>, and a few of the most commonly used ones are given below.</p>
<p><strong>Attribute Directives: e.g. <code>--job-name</code>, <code>--output</code>, <code>--error</code>, <code>--time</code>, <code>--mail-type</code>, <code>--mail-user</code></strong></p>
<p><code>--job-name</code> - Specifies a name for the job. This helps identify the job when querying your queues.</p>
<p><code>--output</code> - Specifies the file in which the standard output will be written. This is the output that would have been printed to the terminal, if you were running the application directly.</p>
<p><code>--error</code> - Specifies the file in which the standard errors will be written.</p>
<p><code>--time</code> - Specifies a time limit for the job after which it will automatically exit, e.g. 01:30:00 for 1.5 hours, or 1-00:00:00 for 1 day.  Providing an accurate time limit will help your queued jobs start running more quickly.</p>
<p><code>--mail-type</code> - Notifies the user by email when various events occur, like when the job starts or ends.</p>
<p><code>--mail-user</code> - Specifies the email address to receive the notifications.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">#SBATCH --jobname=my-kelvin2-job</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1">#SBATCH --output=my-output-file</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1">#SBATCH --error=my-error-file</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1">#SBATCH --time=01:30:00</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1">#SBATCH --mail-type=ALL</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1">#SBATCH --mail-user=&lt;user-email-address&gt;</span>
</code></pre></div>
<p><strong>Partition Directive: <code>--partition</code></strong></p>
<p>The <code>--partition</code> directive should be specified according to the resource requirements and time limit of your job. For example, if you wanted to run a job with a wall time of 3 days, you would need to use a low priority partition otherwise your job would never run, e.g.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">#SBATCH --partition=k2-lowpri</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1">#SBATCH --time=3-00:00:00</span>
</code></pre></div>
<p>The main Kelvin2 partitions along with their time limits and computational resources are shown below. The default partition, if none is specified in the batch script is k2-hipri.</p>
<table>
<thead>
<tr>
<th>Partition</th>
<th>Time Limit</th>
<th>CPU Cores per Node</th>
<th>Memory (GB) per Node</th>
</tr>
</thead>
<tbody>
<tr>
<td>k2-hipri</td>
<td>3 hours</td>
<td>128 (94 Nodes)</td>
<td>773 GB (59 Nodes), 1023 GB (35 Nodes)</td>
</tr>
<tr>
<td>k2-medpri</td>
<td>24 hours</td>
<td>"</td>
<td>"</td>
</tr>
<tr>
<td>k2-lowpri</td>
<td>N/A</td>
<td>"</td>
<td>"</td>
</tr>
<tr>
<td>k2-epsrc</td>
<td>N/A</td>
<td>"</td>
<td>"</td>
</tr>
<tr>
<td>k2-himem</td>
<td>3 days</td>
<td>128 (6 Nodes), 256 (2 Nodes)</td>
<td>2051 GB (4 Nodes) 2063 GB (4 Nodes)</td>
</tr>
<tr>
<td>k2-epsrc-himem</td>
<td>N/A</td>
<td>"</td>
<td>"</td>
</tr>
<tr>
<td>k2-gpu</td>
<td>3 days</td>
<td>48 (8 Nodes), 128 (4 Nodes)</td>
<td>514 GB (8 Nodes), 1031GB (4 Nodes)</td>
</tr>
<tr>
<td>k2-gpu-interactive</td>
<td>3 hours</td>
<td>"</td>
<td>"</td>
</tr>
<tr>
<td>k2-epsrc-gpu</td>
<td>3 days</td>
<td>"</td>
<td>"</td>
</tr>
</tbody>
</table>
<p>Other partitions are also available, including some for specific research groups. A comprehensive list of Kelvin2 nodes, their associated partitions and their computational resources can be found using the <a href="https://slurm.schedmd.com/sinfo.html" target="_blank">sinfo command</a>.</p>
<p><strong>Resource Directives: e.g. <code>--ntasks</code>, <code>--nodes</code>, <code>--cpus-per-task</code>, <code>--mem-per-cpu</code></strong></p>
<p><code>#SBATCH</code> directives for computational resources follow the format</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">#SBATCH --&lt;resource-type&gt;=&lt;amount&gt;</span>
</code></pre></div>
<p><em>MPI Application example</em></p>
<p>If your MPI application requires 40 CPU cores spread across a maximum of 2 nodes and 80GB memory (2GB per CPU core) you would include the directives</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">#SBATCH --ntasks=40</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1">#SBATCH --mem-per-cpu=2G</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1">#SBATCH --nodes=2</span>
</code></pre></div>
<p><em>OpenMP Application example</em></p>
<p>If your OpenMP application require 40 CPU cores all on the same node and 80GB memory (2GB per CPU core) you would include the directives</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">#SBATCH --ntasks=1</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1">#SBATCH --cpus-per-task=40</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">#SBATCH --mem-per-cpu=2G</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1">#SBATCH --nodes=1</span>
</code></pre></div>
<p><strong>GPU Directives: <code>--gres</code></strong></p>
<p>Jobs submitted to the k2-gpu, k2-gpu-interactive (for <a href="#interactive-jobs">interactive jobs</a> only) and k2-epsrc-gpu partitions can access GPUs using the <code>--gres</code> flag by following the below template (<code>&lt;N&gt;</code> is the number of GPUs requested per node)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">#SBATCH --gres=gpu:&lt;gpu-type&gt;:&lt;N&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Available GPU Resources</th>
<th>Example <code>--gres</code> flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>32 x Tesla V100 PCIe 32Gb (4 GPUs on 8 Nodes)</td>
<td><code>#SBATCH --gres=gpu:v100:1</code></td>
</tr>
<tr>
<td>12 x Tesla A100 SXM4 80GB (4 GPUs on 3 Nodes)</td>
<td><code>#SBATCH --gres=gpu:a100:1</code></td>
</tr>
<tr>
<td>28 x CI slices of a Tesla A100 SXM4 80GB (7 slices on 4 GPUs on 1 Node)</td>
<td><code>#SBATCH --gres=gpu:1g.10gb:1</code></td>
</tr>
</tbody>
</table>
<h3 id="loading-modules">Loading Modules</h3>
<p>Kelvin2 has a large repository of software installed directly on the system which can be loaded for the jobs using the batch script.</p>
<p>The <code>module avail</code> command will show the list of applications that are currently installed on the central repository.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">[</span>&lt;username&gt;@login1<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>module<span class="w"> </span>avail
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>---<span class="w">  </span>/opt/gridware/local/el7/etc/modules<span class="w">  </span>---
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span>apps/anaconda/2.5.0/bin
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span>apps/anaconda3/2021.05/bin
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span>apps/anaconda3/2022.10/bin
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span>apps/anaconda3/5.2.0/bin
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span>apps/annovar/20160201/noarch
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span>apps/bamtools/2.3.0/gcc-4.8.5
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span>...
</code></pre></div>
<p>Press <code>space</code> to navigate through the list one page at a time and when done press <code>q</code> to exit.</p>
<p>The most useful commands related to working with modules are:</p>
<ul>
<li><code>module display &lt;module&gt;</code> -  Shows information about the software</li>
<li><code>module load &lt;module&gt;</code> - load the selected module, including its binaries/libraries into the user's environment</li>
<li><code>module unload &lt;module&gt;</code> - removes the module from the user's environment</li>
<li><code>module list</code> - show the currently loaded modules in the user's environment</li>
<li><code>module purge</code> - clear all modules from the user's environment</li>
</ul>
<h3 id="two-batch-script-examples">Two Batch Script Examples</h3>
<p>For illustration, example jobscripts for CPU and GPU applications are shown below, but each should be customised for your specific job. More examples are given in the <strong>Applications</strong> section.</p>
<details class="note">
<summary>CPU Application (with OpenMPI)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1">#SBATCH --job-name=mpi-job-name             # Specify a name for the job</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1">#SBATCH --output=mpi-job-output.out         # Specify where stdout will be written</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1">#SBATCH --error=mpi-job-error.err           # Specify where stderr will be written</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1">#SBATCH --time=01:30:00                     # time limit of 1hr30min</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1">#SBATCH --mail-user=&lt;email address&gt;         # Specify email address for notifications</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1">#SBATCH --mail-type=ALL                     # Specify types of notification (eg job Begin, End)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1">#SBATCH --ntasks=32                         # Number of tasks to run (for MPI tasks this is number of cores) </span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c1">#SBATCH --nodes=4                          # Maximum number of nodes on which to launch tasks </span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c1">#SBATCH --partition=k2-hipri                # Specify SLURM partition to queue the job</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>module<span class="w"> </span>load<span class="w"> </span>mpi/openmpi/4.1.1/gcc-9.3.0<span class="w"> </span><span class="c1"># Load the application and dependencies</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>module<span class="w"> </span>load<span class="w"> </span>&lt;mpi-application&gt;
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>mpirun<span class="w"> </span>&lt;application-command&gt;<span class="w"> </span>-n<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span><span class="c1"># Run the code</span>
</code></pre></div>
</details>
<details class="note">
<summary>GPU Application (MATLAB)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1">#SBATCH --job-name=matlab-job-name</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1">#SBATCH --output=matlab-output.out</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c1">#SBATCH --time=00:30:00</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1">#SBATCH --nodes=1</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1">#SBATCH --ntasks=4</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c1">#SBATCH --mem-per-cpu=5G</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1">#SBATCH --partition=k2-gpu</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1">#SBATCH --gres=gpu:1g.10gb:1</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>module<span class="w"> </span>load<span class="w"> </span>matlab/R2022a
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c1"># Ulster University (UU) users must use UU&#39;s Matlab licence by declaring</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="c1"># (removing comments) these environment variables:</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1">#export MLM_LICENSE_FILE=27000@193.61.190.229</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c1">#export LM_LICENSE_FILE=27000@193.61.190.229</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>matlab<span class="w"> </span>-nosplash<span class="w"> </span>-nodisplay<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;matlab_gpu_script;&quot;</span>
</code></pre></div>
</details>
<h2 id="managing-submitted-jobs">Managing Submitted Jobs</h2>
<p>SLURM also has commands for managing your jobs.</p>
<h3 id="checking-job-status">Checking job status</h3>
<p>You can view the status of your submitted jobs by using the <code>squeue</code> command:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">[</span>&lt;username&gt;@login1<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>squeue<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w">             </span>JOBID<span class="w"> </span>PARTITION<span class="w">     </span>NAME<span class="w">     </span>USER<span class="w"> </span>ST<span class="w">       </span>TIME<span class="w">  </span>NODES<span class="w"> </span>NODELIST<span class="o">(</span>REASON<span class="o">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">          </span>&lt;jobid&gt;<span class="w">  </span>k2-hipri<span class="w"> </span>hello-wo<span class="w">  </span>&lt;username&gt;<span class="w">  </span>R<span class="w">       </span><span class="m">0</span>:02<span class="w">      </span><span class="m">1</span><span class="w"> </span>node103
</code></pre></div></p>
<p>The status of your job is given by the Job State code (ST) and the nodes your job is running on (or the reason it is not running) is in the 'NODELIST(REASON)' column. Common Job State codes are:</p>
<table>
<thead>
<tr>
<th>State Code</th>
<th>State</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>R</strong></td>
<td>Running</td>
<td>Your job is currently running.</td>
</tr>
<tr>
<td><strong>PD</strong></td>
<td>Pending</td>
<td>Your job is waiting for resources to be allocated</td>
</tr>
<tr>
<td><strong>F</strong></td>
<td>Failed</td>
<td>Your job submission has failed.</td>
</tr>
</tbody>
</table>
<p>The definitive list of job state codes are given in the <a href="https://slurm.schedmd.com/squeue.html#SECTION_JOB-STATE-CODES" target="_blank">SLURM documentation</a></p>
<h3 id="cancelling-jobs">Cancelling jobs</h3>
<p>If you need to cancel a pending or running job you can use the <code>scancel</code> command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>scancel<span class="w"> </span>&lt;jobid&gt;
</code></pre></div></p>
<p>Users can delete their own jobs only.</p>
<h3 id="analysing-previous-jobs-using-sacct">Analysing previous jobs using <code>sacct</code></h3>
<p>Jobs you have previously ran can be analysed to check how much of the resources you had allocated were used by the program. More information may be found in the <a href="https://slurm.schedmd.com/sacct.html" target="_blank">SLURM documentation</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sacct<span class="w"> </span>-j<span class="w"> </span>&lt;jobid&gt;<span class="w"> </span>--format<span class="o">=</span><span class="s2">&quot;JobID,jobname,NTasks,nodelist,CPUTime,ReqMem,MaxVMSize,Elapsed&quot;</span>
</code></pre></div>
<h2 id="interactive-jobs">Interactive Jobs</h2>
<p>Interactive jobs allow the user to interact with their applications as they are running on the compute node(s). This is useful for data visualisation and for debugging programs and more complex code compilations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since interactive sessions involve waiting on human input, they are generally an inefficient use of computational resources. As such, we recommend using a batch script whenever possible to run your applications automatically in the background.</p>
</div>
<p>You can launch an interactive session by including the <code>srun</code> command in the terminal, followed by a list of computational resources, followed by <code>--pty bash</code>.</p>
<p>For example, the follow command requests 10 CPU cores and 10GB of RAM on 1 node for a 1 hour period.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">[</span>&lt;username&gt;@login1<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>srun<span class="w"> </span>-p<span class="w"> </span>k2-hipri<span class="w"> </span>-N<span class="w"> </span><span class="m">1</span><span class="w"> </span>-n<span class="w"> </span><span class="m">10</span><span class="w"> </span>--mem-per-cpu<span class="o">=</span>1G<span class="w"> </span>--time<span class="o">=</span><span class="m">1</span>:00:00<span class="w"> </span>--pty<span class="w"> </span>bash
</code></pre></div>
The job will then be queued and launched when resources are allocated on the system. Note that the domain on the terminal will change to a compute node.
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>srun:<span class="w"> </span>job<span class="w"> </span>&lt;jobid&gt;<span class="w"> </span>queued<span class="w"> </span>and<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>resources
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>srun:<span class="w"> </span>job<span class="w"> </span>&lt;jobid&gt;<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>allocated<span class="w"> </span>resources
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="o">[</span>&lt;username&gt;@node103<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$
</code></pre></div></p>
<p>Once connected to a login node you can load modules, set your environment and run your jobs interactively.</p>
<h3 id="interactive-jobs-with-graphical-applications">Interactive jobs with graphical applications</h3>
<p>It is possible to interact with graphical applications on Kelvin2 by launching a VNC server and creating an SSH tunnel.</p>
<ol>
<li>
<p>Launch an interactive job on a compute node by typing the following command into your Kelvin2 terminal. Modify your resource requirements as needed.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="o">[</span>&lt;username&gt;@login3<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>srun<span class="w"> </span>-p<span class="w"> </span>k2-hipri<span class="w"> </span>-N<span class="w"> </span><span class="m">1</span><span class="w"> </span>-n<span class="w"> </span><span class="m">10</span><span class="w"> </span>--mem-per-cpu<span class="o">=</span>1G<span class="w"> </span>--time<span class="o">=</span><span class="m">1</span>:00:00<span class="w"> </span>--pty<span class="w"> </span>bash
</code></pre></div></p>
</li>
<li>
<p>On the compute node, launch a vncserver (TigerVNC) by typing the following into your Kelvin2 terminal:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">[</span>&lt;username&gt;@node181<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>vncserver
</code></pre></div></p>
</li>
<li>
<p>If this is your first time launching a VNC server you will be prompted to set a password. For security reasons, this should be different to your login/SSH password for Kelvin2.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>You<span class="w"> </span>will<span class="w"> </span>require<span class="w"> </span>a<span class="w"> </span>password<span class="w"> </span>to<span class="w"> </span>access<span class="w"> </span>your<span class="w"> </span>desktops.
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>Password:
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>Verify:
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>Would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>enter<span class="w"> </span>a<span class="w"> </span>view-only<span class="w"> </span>password<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span>?<span class="w"> </span>n
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>A<span class="w"> </span>view-only<span class="w"> </span>password<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>used
</code></pre></div></p>
</li>
<li>
<p>Once your vncserver is launched you will have information printed to your screen:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>New<span class="w"> </span><span class="s1">&#39;node181.pri.kelvin2.alces.network:1 (&lt;username&gt;)&#39;</span><span class="w"> </span>desktop<span class="w"> </span>is<span class="w"> </span>node181.pri.kelvin2.alces.network:1
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>Starting<span class="w"> </span>applications<span class="w"> </span>specified<span class="w"> </span><span class="k">in</span><span class="w"> </span>/users/&lt;username&gt;/.vnc/xstartup
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>Log<span class="w"> </span>file<span class="w"> </span>is<span class="w"> </span>/users/&lt;username&gt;/.vnc/node181.pri.kelvin2.alces.network:1.log
</code></pre></div></p>
</li>
<li>
<p>Take note of the number after the compute node address (e.g. the <code>1</code> at the end of <code>node181.pri.kelvin2.alces.network:1</code>). This specifies the port number you need when creating your tunnel. Since the number here is <code>1</code>, we use port <code>5901</code>, if the number <code>7</code>, we would use port <code>5907</code>.</p>
</li>
<li>
<p>In a separate terminal on your local computer, enter the following command to launch an SSH tunnel. Modify your node name and port numbers as appropriate. Here <code>5903</code> specifies the port on your local host and <code>5901</code> comes from the port number noted in the previous step. You will have to log in and authenticate using your usual credentials.</p>
<p><strong>From inside the QUB Network</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">5903</span>:node181.pri.kelvin2.alces.network:5901<span class="w"> </span>&lt;username&gt;@kelvin2.qub.ac.uk
</code></pre></div></p>
<p><strong>From outside the QUB Network</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">5903</span>:node181.pri.kelvin2.alces.network:5901<span class="w"> </span>-p<span class="w"> </span><span class="m">55890</span><span class="w"> </span>-i<span class="w"> </span>/path/to/ssh/key<span class="w"> </span>&lt;username&gt;@login.kelvin.alces.network
</code></pre></div></p>
</li>
<li>
<p>Now open  your VNC application and connect to localhost on port 5903 (or whichever port you chose in Step 6). You will have to enter the password set on Step 3.</p>
</li>
<li>
<p>You will now have a graphical view of a terminal in Kelvin2. From here you may load modules and open graphical applications as required.</p>
</li>
<li>
<p>After you have finished your session</p>
<ul>
<li>disconnect from your graphical session on your VNC application.</li>
<li>
<p>find and close the vncserver on the compute node by typing the following commands into your Kelvin2 terminal.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="o">[</span>&lt;username&gt;@node181<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>vncserver<span class="w"> </span>-list
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>TigerVNC<span class="w"> </span>server<span class="w"> </span>sessions:
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>X<span class="w"> </span>DISPLAY<span class="w"> </span><span class="c1">#     PROCESS ID</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>:1<span class="w">              </span><span class="m">102389</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="o">[</span>&lt;username&gt;@node181<span class="w"> </span><span class="o">[</span>kelvin2<span class="o">]</span><span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>vncserver<span class="w"> </span>-kill<span class="w"> </span>:1
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>Killing<span class="w"> </span>Xvnc<span class="w"> </span>process<span class="w"> </span>ID<span class="w"> </span><span class="m">102389</span>
</code></pre></div>
    - Close the tunnel by exiting the local terminal opened in Step 6.</p>
</li>
</ul>
</li>
</ol>
<h2 id="tips-for-optimising-your-jobscript">Tips for optimising your jobscript</h2>
<ul>
<li>Use the job analysis tool <a href="https://slurm.schedmd.com/sacct.html" target="_blank">sacct</a> to check if you allocated more memory than the necessary for futures jobs with the same application, e.g. <code>sacct -j &lt;job_num&gt; --format="JobID,jobname,NTasks,nodelist,CPUTime,ReqMem,MaxVMSize,Elapsed"</code></li>
<li>Do not allocate more resources than available in the requested nodes or you job will not run.</li>
<li>When possible, try not to allocate a large number of CPUs or a large amount of memory in a single node. Instead, spread the allocation among several nodes. 20 CPUs and 100 GB of memory is a reasonable amount to be allocated in a single node.</li>
<li>Give freedom to Slurm to distribute the resources among the nodes. Use the flags <code>--ntasks</code> and <code>--mem-per-cpu</code> to allocate resources per CPU, rather than <code>--ntasks-per-node</code> or <code>--mem</code>.</li>
<li>Allocate always the correct partition, double check the resources you require, in particular the wall time, and fit it in the particular partition.</li>
<li>Specify an error output different to the standard output. In case the job crashes, this output has useful information about why the job failed, so how it can be fix.</li>
<li>Activate email notifications.</li>
<li>If you are intending to run a large number of similar jobs, consider submitting a <a href="https://slurm.schedmd.com/job_array.html" target="_blank">Job Array</a></li>
</ul>
<h2 id="slurm-cheat-sheets">Slurm cheat sheets</h2>
<details class="note">
<summary>Common job commands</summary>
<table>
<thead>
<tr>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Submit a job</td>
<td style="text-align: left;">sbatch <job script></td>
</tr>
<tr>
<td style="text-align: left;">Delete a job</td>
<td style="text-align: left;">scancel <job ID></td>
</tr>
<tr>
<td style="text-align: left;">Job status (all)</td>
<td style="text-align: left;">squeue</td>
</tr>
<tr>
<td style="text-align: left;">Job status (by job)</td>
<td style="text-align: left;">squeue -j <job ID></td>
</tr>
<tr>
<td style="text-align: left;">Job status (detailed)</td>
<td style="text-align: left;">scontrol show job <job ID></td>
</tr>
<tr>
<td style="text-align: left;">Show expected start time</td>
<td style="text-align: left;">squeue -j <job ID> --start</td>
</tr>
<tr>
<td style="text-align: left;">Start an interactive job</td>
<td style="text-align: left;">srun --pty  /bin/bash</td>
</tr>
<tr>
<td style="text-align: left;">Monitor jobs resource usage</td>
<td style="text-align: left;">sacct -j <job_num> --format="JobID,jobname,NTasks,nodelist,CPUTime,ReqMem,MaxVMSize,Elapsed"</td>
</tr>
</tbody>
</table>
</details>
<details class="note">
<summary>Slurm Environmental variables</summary>
<table>
<thead>
<tr>
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">SLURM_ARRAY_JOB_ID</td>
<td style="text-align: left;">Job array's master job ID number.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_ARRAY_TASK_ID</td>
<td style="text-align: left;">Job array ID (index) number.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_CLUSTER_NAME</td>
<td style="text-align: left;">Name of the cluster on which the job is executing.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_CPUS_PER_TASK</td>
<td style="text-align: left;">Number of cpus requested per task. Only set if the --cpus-per-task option is specified.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_ACCOUNT</td>
<td style="text-align: left;">Account name associated of the job allocation.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_ID</td>
<td style="text-align: left;">The ID of the job allocation.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_NAME</td>
<td style="text-align: left;">Name of the job.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_NODELIST</td>
<td style="text-align: left;">List of nodes allocated to the job.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_NUM_NODES</td>
<td style="text-align: left;">Total number of nodes in the job's resource allocation.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_PARTITION</td>
<td style="text-align: left;">Name of the partition in which the job is running.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_UID</td>
<td style="text-align: left;">The ID of the job allocation. See SLURM_JOB_ID. Included for backwards compatibility.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_JOB_USER</td>
<td style="text-align: left;">User name of the job owner</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_MEM_PER_CPU</td>
<td style="text-align: left;">Same as --mem-per-cpu</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_MEM_PER_NODE</td>
<td style="text-align: left;">Same as --mem</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_NTASKS</td>
<td style="text-align: left;">Same as -n, --ntasks</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_NTASKS_PER_NODE</td>
<td style="text-align: left;">Number of tasks requested per node. Only set if the --ntasks-per-node option is specified.</td>
</tr>
<tr>
<td style="text-align: left;">SLURM_PROCID</td>
<td style="text-align: left;">The MPI rank (or relative process ID) of the current process.</td>
</tr>
</tbody>
</table>
</details>
<p>More information about  Slurm commands, flags and environment variables, can be found in the 
<a href="https://slurm.schedmd.com" target="_blank">Slurm web page</a>.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>